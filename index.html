<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gaze Overlay</title>

<script src="https://webgazer.cs.brown.edu/webgazer.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #000000; /* é»’ã‚¯ãƒ­ãƒã‚­ãƒ¼ */
}

/* WebGazerå†…éƒ¨ç”¨ï¼ˆæ¶ˆã™ã¨å£Šã‚Œã‚‹ã®ã§é€æ˜ã«ã™ã‚‹ï¼‰ */
video, canvas {
  position: fixed !important;
  top: 0;
  left: 0;
  opacity: 0.5 !important; /* 50%ã§è¦‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ */
  z-index: 1000; /* æ‰‹å‰ã«æŒã£ã¦ãã‚‹ */
}

/* è¦–ç·šãƒãƒ¼ã‚«ãƒ¼ */
#gazeDot {
  position: fixed;
  width: 90px;
  height: 90px;
  border-radius: 50%;
  background: rgba(0, 255, 0, 0.35);
  border: 2px solid rgba(0,255,0,0.9);
  pointer-events: none;
  transform: translate(-50%, -50%);
  transition: transform 0.05s linear;
}

/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
#status {
  position: fixed;
  top: 10px;
  left: 10px;
  color: white;
  font-family: sans-serif;
  font-size: 14px;
  opacity: 0.7;
}
</style>
</head>

<body>
<div id="gazeDot"></div>
<div id="status">Initializing Eye Tracker...</div>

<script>
const dot = document.getElementById("gazeDot");
const statusText = document.getElementById("status");

/* ğŸ”§ å®‰å®šåŒ–è¨­å®š */
webgazer.setTracker("clmtrackr");        // è»½é‡ãƒˆãƒ©ãƒƒã‚«ãƒ¼
webgazer.setRegression("ridge");
webgazer.saveDataAcrossSessions(false);
localStorage.clear();

/* è¦–ç·šå–å¾— */
webgazer
  .setGazeListener((data) => {
    if (!data) return;
    dot.style.left = data.x + "px";
    dot.style.top  = data.y + "px";
  })
  .begin();

/* UIéè¡¨ç¤ºè¨­å®š */
webgazer.showVideo(true);
webgazer.showPredictionPoints(true);
webgazer.showFaceOverlay(true); // ğŸ‘€æ¶ˆã™

/* æ ¡æ­£ã‚¬ã‚¤ãƒ‰ */
statusText.textContent = "ä¸­å¤®â†’å››éš…ã‚’è¦‹ã‚‹ï¼†ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ ¡æ­£";

let clickCount = 0;
window.addEventListener('click', () => {
  clickCount++;

  dot.style.background = "rgba(255,255,0,0.8)";
  setTimeout(() => {
    dot.style.background = "rgba(0,255,0,0.35)";
  }, 150);

  if (clickCount >= 8) {
    statusText.style.display = "none";
  }
});
</script>
</body>
</html>
